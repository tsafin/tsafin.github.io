<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Caché MapReduce - introduction to BigData and MapReduce concept • Timur Safin - Making No Sense</title>
    <meta name="description" content="Several years ago everyone got mad&nbsp;about BigData – nobody knew when smallish data will become BIGDATA, but all knows
	that it’s trendy and the way to go. Time passed, BigData is not a buzz anymore (most of us missed the moment when Gartner
	has removed BigData term from their 2016 buzzword 2016 curve http://www.kdnuggets.com/2015/08/gartner-2015-hype-cycle-big-data-is-out-machine-learning-is-in.html),
	so it’s probably a good time to look back and realize what it is (what it was)…

">
    <meta name="keywords" content="">
    
    	<!-- Twitter Cards -->
	<meta name="twitter:title" content="Caché MapReduce - introduction to BigData and MapReduce concept">
	<meta name="twitter:description" content="Several years ago everyone got mad&nbsp;about BigData – nobody knew when smallish data will become BIGDATA, but all knows
	that it’s trendy and the way to go. Time passed, BigData is not a buzz anymore (most of us missed the moment when Gartner
	has removed BigData term from their 2016 buzzword 2016 curve http://www.kdnuggets.com/2015/08/gartner-2015-hype-cycle-big-data-is-out-machine-learning-is-in.html),
	so it’s probably a good time to look back and realize what it is (what it was)…

">
	<meta name="twitter:site" content="@tsafin">
	
	
	<meta name="twitter:card" content="summary_large_image">
	<meta name="twitter:image" content="http://tsafin.net/images/landscapes/feature10.jpg">
	
	<!-- Open Graph -->
	<meta property="og:locale" content="en">
	<meta property="og:type" content="article">
	<meta property="og:title" content="Caché MapReduce - introduction to BigData and MapReduce concept">
	<meta property="og:description" content="Several years ago everyone got mad&nbsp;about BigData – nobody knew when smallish data will become BIGDATA, but all knows
	that it’s trendy and the way to go. Time passed, BigData is not a buzz anymore (most of us missed the moment when Gartner
	has removed BigData term from their 2016 buzzword 2016 curve http://www.kdnuggets.com/2015/08/gartner-2015-hype-cycle-big-data-is-out-machine-learning-is-in.html),
	so it’s probably a good time to look back and realize what it is (what it was)…

">
	<meta property="og:url" content="http://tsafin.net/blog/mapreduce/mapreduce-english-part-i/">
	<meta property="og:site_name" content="Timur Safin - Making No Sense">

    <link rel="canonical" href="http://tsafin.net/blog/mapreduce/mapreduce-english-part-i/">

    <link href="http://tsafin.net/atom.xml" type="application/atom+xml" rel="alternate" title="Timur Safin - Making No Sense Atom Feed">
    <link href="http://tsafin.net/sitemap.xml" type="application/xml" rel="sitemap" title="Sitemap">

    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="320">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="cleartype" content="on">

    <link rel="stylesheet" href="http://tsafin.net/css/main.css">
    <!-- HTML5 Shiv and Media Query Support for IE -->
    <!--[if lt IE 9]>
      <script src="http://tsafin.net/js/vendor/html5shiv.min.js"></script>
      <script src="http://tsafin.net/js/vendor/respond.min.js"></script>
    <![endif]-->
  </head>

  <body id="js-body">
    <!--[if lt IE 9]><div class="upgrade notice-warning"><strong>Your browser is quite old!</strong> Why not <a href="http://whatbrowser.org/">upgrade to a newer one</a> to better enjoy this site?</div><![endif]-->

    <header id="masthead">
  <div class="inner-wrap">
    <a href="http://tsafin.net/" class="site-title">Timur Safin - Making No Sense</a>
    <nav role="navigation" class="menu top-menu">
        <ul class="menu-item">
	<li class="home"><a href="/">Timur Safin - Making No Sense</a></li>
	 
      
      <li><a href="http://tsafin.net/blog/" >Articles</a></li>
    
      
      <li><a href="http://tsafin.net/projects/" >Projects</a></li>
    
      
      <li><a href="http://tsafin.net/resume/" >About</a></li>
    
</ul>
    </nav>
  </div><!-- /.inner-wrap -->
</header><!-- /.masthead -->
    <nav role="navigation" id="js-menu" class="sliding-menu-content">
  <h5>Timur Safin - Making No Sense <span>Table of Contents</span></h5>
  <ul class="menu-item">
    <li>
      <a href="http://tsafin.net/blog/">
        
        <div class="title">Articles</div>
        <p class="excerpt">Blog posts and random rumblings...</p>
      </a>
    </li><li>
      <a href="http://tsafin.net/projects/">
        
        <div class="title">Projects</div>
        <p class="excerpt">Open-source projects</p>
      </a>
    </li><li>
      <a href="http://tsafin.net/resume/">
        
        <div class="title">About</div>
        <p class="excerpt">Resume and such...</p>
      </a>
    </li>
  </ul>
</nav>
<button type="button" id="js-menu-trigger" class="sliding-menu-button lines-button x2" role="button" aria-label="Toggle Navigation">
  <span class="nav-lines"></span>
</button>

<div id="js-menu-screen" class="menu-screen"></div>


    <div id="page-wrapper">
      <div id="main" role="main">
	<article class="wrap" itemscope itemtype="http://schema.org/Article">
		
		<div class="page-feature">
			<div class="page-image">
				<img src="http://tsafin.net/images/landscapes/feature10.jpg" class="page-feature-image" alt="Caché MapReduce - introduction to BigData and MapReduce concept" itemprop="image">
				
			</div><!-- /.page-image -->
		</div><!-- /.page-feature -->
		
		
<nav class="breadcrumbs">
    <span itemscope itemtype="http://data-vocabulary.org/Breadcrumb">
      <a href="http://tsafin.net" itemprop="url">
        <span itemprop="title">Home</span>
    </a> ›
    <span itemscope itemtype="http://data-vocabulary.org/Breadcrumb">
      <a href="http://tsafin.net/blog/" itemprop="url">
        <span itemprop="title">Blog</span>
    </a>
    </span>
</nav>
<!-- /.breadcrumbs -->


<div class="breadcrumbs sm">
    <a href="https://community.intersystems.com/post/cach%C3%A9-mapreduce-introduction-bigdata-and-mapreduce-concept" itemprop="url">
        https://community.intersystems.com/post/cach%C3%A9-mapreduce-introduction-bigdata-and-mapreduce-concept&nbsp;<span class="glyphicon glyphicon-share" aria-hidden="true"></span>
    </a>
</div>

		<div class="page-title">
			<h1>Caché MapReduce - introduction to BigData and MapReduce concept</h1>
		</div>
		<div class="inner-wrap">
			<div id="content" class="page-content" itemprop="articleBody">
				<p>Several years ago everyone got mad&nbsp;about BigData – nobody knew when smallish data will become BIGDATA, but all knows
	that it’s trendy and the way to go. Time passed, BigData is not a buzz anymore (most of us missed the moment when Gartner
	has removed BigData term from their 2016 buzzword 2016 curve <a href="http://www.kdnuggets.com/2015/08/gartner-2015-hype-cycle-big-data-is-out-machine-learning-is-in.html">http://www.kdnuggets.com/2015/08/gartner-2015-hype-cycle-big-data-is-out-machine-learning-is-in.html</a>),
	so it’s probably a good time to look back and realize what it is (what it was)…</p>

<h2>When it becomes “BigData”?</h2>

<p>Let’s start from the beginning: what is the moment when “not so big data” becomes BigData? Here was the answer in 2015 from
	David Kanter<a href="#_ftn1" name="_ftnref1" title="">[1]</a>, one of most respected, well known x86 architecture specialists</p>
<!-- <p><a href="https://twitter.com/thekanter/status/559034352474914816">https://twitter.com/thekanter/status/559034352474914816</a></p> -->

<blockquote class="twitter-tweet" data-lang="ru"><p lang="en" dir="ltr">&quot;<a href="https://twitter.com/jrk">@jrk</a>: This: <a href="http://t.co/PSWxSjAbnA">http://t.co/PSWxSjAbnA</a>&quot; data isn&#39;t big until it cannot be held in DRAM on a 2S server. Today that is &gt;3TB <a href="https://twitter.com/hashtag/bigdata?src=hash">#bigdata</a> <a href="https://twitter.com/hashtag/myths?src=hash">#myths</a></p>&mdash; David Kanter (@TheKanter) <a href="https://twitter.com/TheKanter/status/559034352474914816">24 января 2015 г.</a></blockquote>
<script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>

<p>So if you have “only a couple” of terabytes data then you probably could find an appropriate hardware configuration which
	will held it entirely in memory, [well, given enough of motivation and budget], so it’s probably not yet “the BigData”.</p>
<p>BIGDATA starts from the moment when vertical upscale approaches (finding bigger hardware) stop to work because there is no
	bigger hardware (which still is reasonably expensive) available at the moment, so you need to start to think rather horizontally,
	and not vertically.</p>

<h2>Simpler the better - MapReduce</h2>

<p>Ok, now we know volume size which would be threshold for BigData approach, then we need to figure out appropriate approach
	which we will use for handling such big volume. One of the first approaches started to be used with BigData was (and still
	is) the <a href="https://en.wikipedia.org/wiki/MapReduce">MapReduce</a> programming model. There are multiple known programming
	models for big data which are probably simpler and may be more flexible than MapReduce, but MapReduce is definitely the
	most simplistic, well known, but not necessary the most efficient one.</p>
<p>And, if one talks about some database platform as supporting BigData, he, most probably, means that platforms does support
	some MapReduce scenario using some built-in or external interfaces and infrastructure.</p>
<p><em>Putting it the other way: if there is no MapReduce – you could not claim BigData support in the platform!</em></p>
<p>If you were outside of internet last 10 years and missed MapReduce then we will try to explain it in details quite soon,
	but for now please remember that MapReduce is a generic paradigm to get wide scalability effect using very simple (albeit
	not very much efficient) instruments.</p>
<p>It's frequently observed that simplest approach allows to get better results, and, most probably, using least expensive way.
	Even being not the most efficient way, it will be used longer, and will have better chances to get widespread usage with
	easier learning curve.</p>
<p>This effect has happened with MapReduce model, while being very simple one, it’s got widely used in many areas, where original
	authors could not even anticipate it at the beginning.</p>
<h2>Caché specific scalability approaches</h2>
<p>Historically, InterSystems Caché has many well established tools for both vertical and horizontal scalability: as we know
	it's not only the database server, but also is the application server, which uses ECP protocol for scalability and high-availability.</p>
<p>The problem with ECP protocol – while being very much optimized for coherent parallel execution on many nodes, it still very
	dependent on the write daemon performance of a single node (central database server). ECP capabilities help you when you
	need to add extra CPU cores with the modest write-daemon activity, but not will help you to scale horizontally the write
	activity, because the database server will still be the bottleneck.</p>
<p>Modern BigData applications implicitly assume the different or rather opposite approach – to scale performance horizontally
	using each particular node write capabilities. In reverse to ECP approach, when data is brought to application on several
	nodes, we rather assume that application size is thin/”reasonable” but data amount is enormous, so we better to bring code
	to the local data, and not the opposite. This sort of partitioning is named “sharding” and will be addressed in Caché SQL
	engine in general with some future InterSystems Caché solutions, but in a mean-time we could try to use some simpler, but
	already available means, using that we have <em>today</em>.</p>
<p>Although, I’m not big fan of original BigData approach (see Mike Stonebraker articles <a href="http://cacm.acm.org/blogs/blog-cacm/149074-possible-hadoop-trajectories/fulltext">“Possible Hadoop Trajectories”</a>,
	<a href="http://cacm.acm.org/blogs/blog-cacm/177467-hadoop-at-a-crossroads/fulltext">“Hadoop at a crossroads?”</a>, [
	<a
		href="https://habrahabr.ru/post/270017/">Russian translation is here</a> ]), and it’s not a panacea of any sorts, but MapReduce still may be a good start for future
		developments, so let us get whatever we have in the Caché as development platform, and implement some simplified MapReduce
		which may be still helpful for developers right away.</p>
<h2>Google MapReduce</h2>
<p>The original Google MapReduce implementation was in C++, but coincidentally, the wide usage in the industry MapReduce achieved
	only thanks Apache Hadoop implementation which was in the different language - Java. In any case, regardless of a particular
	implementation language, the idea is more or less the same, be it C++, Java, Go, or, in our case, Caché ObjectScript. [Though
	for ObjectScript case we will use a few shortcuts, which are possible thanks to hierarchical arrays capabilities also known
	as globals].</p>
<p><img alt="" src="/assets/google-apreduce-illustration_0.png"></p>
<p><small>Figure: MapReduce Execution Overview from "MapReduce: Simplified Data Processing on Large Clusters", OSDI-2004</small></p>
<p>Here is the simplistic MapReduce algorithm depicted in the picture above:</p>
<ol>
	<li>We have a bunch of input files or, potentially infinite, data stream, which we could somehow <em>partition</em> to the number
		of independent chunks;</li>
	<li>Also we have some number of <em>parallel workers</em> (local to the current node or probably remote) which will be assigned
		to some input chunks (this is called “<strong>map phase</strong>”);</li>
	<li>Those workers proceed <em>input data stream</em>(s) and then <em>emit</em> output data in a simple key-value form to the
		<em>output stream</em>(s).The output stream written to simple files or anywhere else (i.e. to cluster wide filesystem,
		like Google GFS or Apache HDFS, based on some external magic).</li>
	<li>At the next stage, “<strong>reduce phase</strong>“, we have another set of workers, which do their “reduction” work. They
		read value collections for some given key, and provide resultant key-value written to the output files (which are still
		residing on some magical cluster file-systems).</li>
	<li>MapReduce approach is batch by their nature. It’s unable to handle true infinite input-streams and will wait completion
		of each stage (map or reduce) before going to the next pipeline. This is difference with more modern “streaming” approaches
		used in Apache Kafka, which could handle in parallel infinite input streams.</li>
</ol>
<p>Is it clear? Probably, not yet. Let me try to clarify it using classical word-count example, given in the original Google’
	article.</p>
<p>Consider a case when we need to count the number of unique words in the collection of files.</p>
<p>I’m C++ developer in my background, so any algorithm became crystal clear once we see true C++ example. On the other hand,
	if you have no prior C++ knowledge then bear with me, I’ll try to explain it later, using simplified algorithmic language.</p>
<div>

<figure class="highlight"><pre><code class="language-cpp" data-lang="cpp"><span class="cp">#include "mapreduce/mapreduce.h"
</span>
<span class="c1">// User's map function</span>
<span class="k">class</span> <span class="nc">WordCounter</span> <span class="o">:</span> <span class="k">public</span> <span class="n">Mapper</span> <span class="p">{</span>
<span class="nl">public:</span>
    <span class="k">virtual</span> <span class="kt">void</span> <span class="n">Map</span><span class="p">(</span><span class="k">const</span> <span class="n">MapInput</span><span class="o">&amp;</span><span class="n">amp</span><span class="p">;</span> <span class="n">input</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">const</span> <span class="n">string</span><span class="o">&amp;</span><span class="n">amp</span><span class="p">;</span> <span class="n">text</span> <span class="o">=</span> <span class="n">input</span><span class="p">.</span><span class="n">value</span><span class="p">();</span>
        <span class="k">const</span> <span class="kt">int</span> <span class="n">n</span> <span class="o">=</span> <span class="n">text</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>

        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="p">)</span> <span class="p">{</span>
            <span class="c1">// Skip past leading whitespace</span>
            <span class="k">while</span> <span class="p">((</span><span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">)</span> <span class="o">&amp;</span><span class="n">amp</span><span class="p">;</span><span class="o">&amp;</span><span class="n">amp</span><span class="p">;</span> <span class="n">isspace</span><span class="p">(</span><span class="n">text</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
                <span class="n">i</span><span class="o">++</span><span class="p">;</span>

            <span class="c1">// Find word end</span>
            <span class="kt">int</span> <span class="n">start</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
            <span class="k">while</span> <span class="p">((</span><span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">)</span> <span class="o">&amp;</span><span class="n">amp</span><span class="p">;</span><span class="o">&amp;</span><span class="n">amp</span><span class="p">;</span> <span class="o">!</span><span class="n">isspace</span><span class="p">(</span><span class="n">text</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
                <span class="n">i</span><span class="o">++</span><span class="p">;</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">start</span> <span class="o">&lt;</span> <span class="n">i</span><span class="p">)</span>
                <span class="n">Emit</span><span class="p">(</span><span class="n">text</span><span class="p">.</span><span class="n">substr</span><span class="p">(</span><span class="n">start</span><span class="p">,</span><span class="n">i</span><span class="o">-</span><span class="n">start</span><span class="p">),</span><span class="s">"1"</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">};</span>

<span class="n">REGISTER_MAPPER</span><span class="p">(</span><span class="n">WordCounter</span><span class="p">);</span>

<span class="c1">// User's reduce function</span>
<span class="k">class</span> <span class="nc">Adder</span> <span class="o">:</span> <span class="k">public</span> <span class="n">Reducer</span> <span class="p">{</span>
    <span class="k">virtual</span> <span class="kt">void</span> <span class="n">Reduce</span><span class="p">(</span><span class="n">ReduceInput</span><span class="o">*</span> <span class="n">input</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// Iterate over all entries with the</span>
        <span class="c1">// same key and add the values</span>
        <span class="n">int64</span> <span class="n">value</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

        <span class="k">while</span> <span class="p">(</span><span class="o">!</span><span class="n">input</span><span class="o">-&gt;</span><span class="n">done</span><span class="p">())</span> <span class="p">{</span>
            <span class="n">value</span> <span class="o">+=</span> <span class="n">StringToInt</span><span class="p">(</span><span class="n">input</span><span class="o">-&gt;</span><span class="n">value</span><span class="p">());</span>
            <span class="n">input</span><span class="o">-&gt;</span><span class="n">NextValue</span><span class="p">();</span>
        <span class="p">}</span>
        <span class="c1">// Emit sum for input-&gt;key()</span>
        <span class="n">Emit</span><span class="p">(</span><span class="n">IntToString</span><span class="p">(</span><span class="n">value</span><span class="p">));</span>
    <span class="p">}</span>
<span class="p">};</span>

<span class="n">REGISTER_REDUCER</span><span class="p">(</span><span class="n">Adder</span><span class="p">);</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">**</span> <span class="n">argv</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">ParseCommandLineFlags</span><span class="p">(</span><span class="n">argc</span><span class="p">,</span> <span class="n">argv</span><span class="p">);</span>
    <span class="n">MapReduceSpecification</span> <span class="n">spec</span><span class="p">;</span>

    <span class="c1">// Store list of input files into "spec"</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">argc</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">MapReduceInput</span><span class="o">*</span> <span class="n">input</span> <span class="o">=</span> <span class="n">spec</span><span class="p">.</span><span class="n">add_input</span><span class="p">();</span>
        <span class="n">input</span><span class="o">-&gt;</span><span class="n">set_format</span><span class="p">(</span><span class="s">"text"</span><span class="p">);</span>
        <span class="n">input</span><span class="o">-&gt;</span><span class="n">set_filepattern</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
        <span class="n">input</span><span class="o">-&gt;</span><span class="n">set_mapper_class</span><span class="p">(</span><span class="s">"WordCounter"</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="c1">// Specify the output files:</span>
    <span class="c1">// /gfs/test/freq-00000-of-00100</span>
    <span class="c1">// /gfs/test/freq-00001-of-00100</span>
    <span class="c1">// ...</span>
    <span class="n">MapReduceOutput</span><span class="o">*</span> <span class="n">out</span> <span class="o">=</span> <span class="n">spec</span><span class="p">.</span><span class="n">output</span><span class="p">();</span>
    <span class="n">out</span><span class="o">-&gt;</span><span class="n">set_filebase</span><span class="p">(</span><span class="s">"/gfs/test/freq"</span><span class="p">);</span>
    <span class="n">out</span><span class="o">-&gt;</span><span class="n">set_num_tasks</span><span class="p">(</span><span class="mi">100</span><span class="p">);</span>
    <span class="n">out</span><span class="o">-&gt;</span><span class="n">set_format</span><span class="p">(</span><span class="s">"text"</span><span class="p">);</span>
    <span class="n">out</span><span class="o">-&gt;</span><span class="n">set_reducer_class</span><span class="p">(</span><span class="s">"Adder"</span><span class="p">);</span>

    <span class="c1">// Optional: do partial sums within map</span>
    <span class="c1">// tasks to save network bandwidth</span>
    <span class="n">out</span><span class="o">-&gt;</span><span class="n">set_combiner_class</span><span class="p">(</span><span class="s">"Adder"</span><span class="p">);</span>

    <span class="c1">// Tuning parameters: use at most 2000</span>
    <span class="c1">// machines and 100 MB of memory per task</span>
    <span class="n">spec</span><span class="p">.</span><span class="n">set_machines</span><span class="p">(</span><span class="mi">2000</span><span class="p">);</span>
    <span class="n">spec</span><span class="p">.</span><span class="n">set_map_megabytes</span><span class="p">(</span><span class="mi">100</span><span class="p">);</span>
    <span class="n">spec</span><span class="p">.</span><span class="n">set_reduce_megabytes</span><span class="p">(</span><span class="mi">100</span><span class="p">);</span>

    <span class="c1">// Now run it</span>
    <span class="n">MapReduceResult</span> <span class="n">result</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">MapReduce</span><span class="p">(</span><span class="n">spec</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">amp</span><span class="p">;</span><span class="n">result</span><span class="p">))</span> <span class="n">abort</span><span class="p">();</span>
    <span class="c1">// Done: 'result' structure contains info</span>
    <span class="c1">// about counters, time taken, number of</span>
    <span class="c1">// machines used, etc.</span>
 
   <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span></code></pre></figure>
</div>
<ol>
	<li>
		<p>The program is invoked with the list of files it should process (passed in standard argc/argv);</p>
	</li>
	<li>MapReduceInput object instantiate with each input argument, and scheduled to run mapper class (WordCounter) for each input;</li>
	<li>MapReduceOutput is instantiated to output data to some “magical” Google cluster filesystem (e.g. /gfs/test/*);</li>
	<li>Reducer and combiner classes assigned to C++ class Adder, implemented in this same program;</li>
	<li>Function Map in Mapper class (implemented by WordCounter class in our case) receives input data via generic MapInput interface.
		In this case it will be file reading interface. It gets content of this data source via value() function, and length of
		the data source via size() function;</li>
	<li>For the purposes of the original exercise it should ignore all whitespaces (isspace(x)), and count anything between white-spaces
		as a word. The word found is then written to output stream via Emit(word, “1”) function;</li>
	<li>Function Reduce, in the Reducer class (implemented by Adder class), receives reducer input data via generic ReduceInput
		interface. This function called for some particular key value (found word in the mapper stage) with the collection of all
		values sent for this key from mapper (sequence of 1 in our case). The responsibility of a reducer function is to count
		these 1s and emit their sum to the output channel.</li>
	<li>This was responsibility of a MapReduce master to prepare such input collection of values for the given key. Details of particular
		implementation will heavily dependent of a protocol used in the cluster, so we will leave it outside of this story. In
		our case, for the Caché ObjectScript implementation it will be quite easy, thanks to sorted nature of globals.</li>
	<li>There are cases when one or more extra reduce step(s) will be required (i.e. if 1<sup>st</sup> reduce step didn’t process
		whole input data set), then there is Combiner step(s) used, which will aggregate the data collected by prior (1<sup>st</sup>)
		reduce step. Depending on circumstances and algorithm used, you may need to use multiple combiner steps for aggregation
		of generated data.</li>
</ol>
<p>Is it clear already? No? Ok, here is simplified description of the algorithm Google MapReduce implementation (which is looking
	like Python, but is not actual Python):</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="nb">map</span><span class="p">(</span><span class="n">String</span> <span class="n">key</span><span class="p">,</span> <span class="n">String</span> <span class="n">value</span><span class="p">):</span>
    <span class="o">//</span> <span class="n">key</span><span class="p">:</span> <span class="n">document</span> <span class="n">name</span>
    <span class="o">//</span> <span class="n">value</span><span class="p">:</span> <span class="n">document</span> <span class="n">contents</span>
    <span class="k">for</span> <span class="n">each</span> <span class="n">word</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">value</span><span class="p">:</span>
        <span class="n">EmitIntermediate</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="s">"1"</span><span class="p">);</span>

<span class="nb">reduce</span><span class="p">(</span><span class="n">String</span> <span class="n">key</span><span class="p">,</span> <span class="n">Iterator</span> <span class="n">values</span><span class="p">):</span>
    <span class="o">//</span> <span class="n">key</span><span class="p">:</span> <span class="n">a</span> <span class="n">word</span>
    <span class="o">//</span> <span class="n">values</span><span class="p">:</span> <span class="n">a</span> <span class="nb">list</span> <span class="n">of</span> <span class="n">counts</span>
    <span class="nb">int</span> <span class="n">result</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">for</span> <span class="n">each</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">values</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="n">ParseInt</span><span class="p">(</span><span class="n">v</span><span class="p">);</span>
    <span class="n">Emit</span><span class="p">(</span><span class="n">AsString</span><span class="p">(</span><span class="n">result</span><span class="p">));</span></code></pre></figure>

<p>Responsibility of a map function to generate list of &lt;key,value&gt; pairs. Those pairs shuffled and sorted elsewhere,
	on the controller nodes, and sent to reducer I consolidated collections for each separate key. Responsibility of reduce
	function – get collection of values for the given key, and generate the output key-value pair or list of such pairs. (The
	number of words for our case)</p>
<p>In the classical MapReduce implementation transformation of a collection of &lt;key, value&gt; to the separate collections
	of &lt;key, &lt;value(s)&gt;&gt; is most time consuming operation. However, it will not be a such big deal in our Caché
	implementation, because b-tree* -based storage will do all the ground work for us, if we use global as our intermediate
	storage. More details later.</p>
<p><em>This is probably enough for the introduction part – we have not provided anything ObjectScript related, but have provide enough of details of MapReduce&nbsp;algorithm for which the corresponding ObjectScript implementation will be shown in the later parts of this series. Stay tuned.</em></p>
<div>&nbsp;
	<hr align="left" size="1" width="33%">
	<div id="ftn1">
		<p><a href="#_ftnref1" name="_ftn1" title="">[1]</a> FWIW, when I was in the Intel team which was developing "next-generation"
			processor architecture, I was using David Kanter' <a href="http://www.realworldtech.com/nehalem/">Nehalem materials</a>			for learning CPU internals, because internal Intel HAS and MAS materials were too low-level and hard to dig in to for
			unexperienced hardware engineer, while&nbsp; David Kanter’s articles has explained very well internals of Nehalem architecture
			in very clear, human readable fashion.</p>
	</div>
</div>
				<hr />
				<footer class="page-footer">
					

<div class="author-image">
    <img src="http://tsafin.net/images/tsafin_twitter_small_logo.jpg" alt="Timur Safin">
</div>
<!-- ./author-image -->
<div class="author-content">
    <h3 class="author-name">Written by <span itemprop="author">Timur Safin</span></h3>
    <p class="author-bio"></p>
</div>
<!-- ./author-content -->
					<div class="inline-btn">
	<a class="btn-social twitter" href="https://twitter.com/intent/tweet?text=Caché%20MapReduce%20-%20introduction%20to%20BigData%20and%20MapReduce%20concept&amp;url=http://tsafin.net/blog/mapreduce/mapreduce-english-part-i/&amp;via=tsafin" target="_blank"><i class="fa fa-twitter" aria-hidden="true"></i> Share on Twitter</a>
	<a class="btn-social facebook" href="https://www.facebook.com/sharer/sharer.php?u=http://tsafin.net/blog/mapreduce/mapreduce-english-part-i/" target="_blank"><i class="fa fa-facebook" aria-hidden="true"></i> Share on Facebook</a>
	<a class="btn-social google-plus"  href="https://plus.google.com/share?url=http://tsafin.net/blog/mapreduce/mapreduce-english-part-i/" target="_blank"><i class="fa fa-google-plus" aria-hidden="true"></i> Share on Google+</a>
</div><!-- /.share-this -->

					<div class="page-meta">
	<p>Updated <time datetime="2016-08-18T20:56:00Z" itemprop="datePublished">August 18, 2016</time></p>
</div><!-- /.page-meta -->
				</footer><!-- /.footer -->
				<aside>
					<hr />
<div id="disqus_thread"></div>
<script type="text/javascript">
	/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
	var disqus_shortname = 'tsafin-net';

	/* * * DON'T EDIT BELOW THIS LINE * * */
	(function() {
		var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
		dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
		(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
	})();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

				</aside>
			</div><!-- /.content -->
		</div><!-- /.inner-wrap -->
		
	</article><!-- ./wrap -->
</div><!-- /#main -->

      <footer role="contentinfo" id="site-footer">
	<nav role="navigation" class="menu bottom-menu">
		<ul class="menu-item">
		
      
			<li><a href="http://tsafin.net/" >Home</a></li>
		
      
			<li><a href="http://tsafin.net/blog/" >Articles</a></li>
		
      
			<li><a href="http://tsafin.net/projects/" >Projects</a></li>
		
      
			<li><a href="http://tsafin.net/about/" >About</a></li>
		
		</ul>
	</nav><!-- /.bottom-menu -->
	<p class="copyright">&#169; 2020 <a href="http://tsafin.net">Timur Safin - Making No Sense</a> powered by <a href="http://jekyllrb.com" rel="nofollow">Jekyll</a> + <a href="http://mmistakes.github.io/skinny-bones-jekyll/" rel="nofollow">Skinny Bones</a>.</p>
</footer>

    </div>

    <script src="http://tsafin.net/js/vendor/jquery-1.9.1.min.js"></script>
    <script src="http://tsafin.net/js/main.js"></script>

    

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-84704404-1', 'auto');
  ga('require', 'linkid');
  ga('send', 'pageview');

</script>


<!-- Yandex.Metrika counter -->
<script type="text/javascript">
    (function (d, w, c) {
        (w[c] = w[c] || []).push(function() {
            try {
                w.yaCounter40768979 = new Ya.Metrika({
                    id:40768979,
                    clickmap:true,
                    trackLinks:true,
                    accurateTrackBounce:true
                });
            } catch(e) { }
        });

        var n = d.getElementsByTagName("script")[0],
            s = d.createElement("script"),
            f = function () { n.parentNode.insertBefore(s, n); };
        s.type = "text/javascript";
        s.async = true;
        s.src = "https://mc.yandex.ru/metrika/watch.js";

        if (w.opera == "[object Opera]") {
            d.addEventListener("DOMContentLoaded", f, false);
        } else { f(); }
    })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/40768979" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
<!-- /Yandex.Metrika counter -->



  </body>

</html>
